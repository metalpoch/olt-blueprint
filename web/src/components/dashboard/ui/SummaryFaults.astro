---
import WarningIcon from "../../../assets/icons/warning.svg";
import Image from "astro/components/Image.astro";
const { data, err } = Astro.props;

const init = data && Object.values(data)[0];
const end = data && Object.values(data)[Object.values(data).length - 1];

const faults = ((end.unknowns - init.unknowns) * 100) / init.unknowns;
const strFaults = `${faults >= 0 ? "+" : ""}${faults.toFixed(2)}%`;
---

<article
  class="flex flex-1/3 md:flex-1/5 flex-col gap-2 px-6 py-3 w-1/3 rounded-lg bg-[#121b31] border-2 border-[hsl(217,33%,20%)]"
>
  <div class="w-full flex justify-between">
    <h2 class="text-slate-400">ONT con fallas</h2>
    <Image src={WarningIcon} width={20} height={20} alt="icono de pulso" />
  </div>
  <h3 class="font-bold text-3xl">
    {
      new Intl.NumberFormat("es-ES", {
        notation: "compact",
        maximumFractionDigits: 2,
      }).format(end.unknowns)
    }
  </h3>
  <p class="text-slate-400 text-sm">{strFaults} de crecimiento</p>
  {
    faults < 0 ? (
      <p class="text-green-300 text-sm">↓ {strFaults}</p>
    ) : (
      <p class="text-red-300 text-sm">↑ {strFaults}</p>
    )
  }
</article>
